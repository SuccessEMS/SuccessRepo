<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" xml:lang="en-us" MadCap:lastBlockDepth="4" MadCap:lastHeight="6859" MadCap:lastWidth="1000">
    <head><title></title>
    </head>
    <body>
        <h1>Install or Upgrade the EMS Kiosk App</h1>
        <ol start="1">
            <li>Verify that the&#160;<a href="https://success.emssoftware.com/?title=Installation_%26_Setup_Guides/EMS_Kiosk__App/Installing_EMS_Kiosk/03System_Requirements_and_Prerequisites_for_EMS_Kiosk_App" title="System Requirements and Prerequisites for EMS Kiosk App">System Requirements and Prerequisites</a>&#160;for EMS Kiosk App have&#160;been fulfilled:</li>
        </ol>
        <ol start="1">
            <li>Patches</li>
            <li>API</li>
            <li><a href="https://docs.microsoft.com/en-us/aspnet/core/publishing/iis#install-the-net-core-windows-server-hosting-bundle?tabs=aspnetcore2x" title="https://docs.microsoft.com/en-us/aspnet/core/publishing/iis?tabs=aspnetcore2x#install-the-net-core-windows-server-hosting-bundle">.NET Core Windows Server Hosting Bundle</a>
            </li>
        </ol>
        <ol start="1">
            <li>Run the installer.</li>
            <li>When complete, open a CMD prompt as an Admin.</li>
            <li>Right-click the Start button and select Command Prompt (admin).</li>
            <li>Type&#160;net stop was /y&#160;&lt;enter&gt;.</li>
            <li>Type&#160;net start w3svc&#160;&lt;enter&gt;.</li>
        </ol>
        <ol start="4">
            <li>EMS Platform Services</li>
        </ol>
        <ol start="1">
            <li>You may want to test that Platform Services is properly installed by navigating to the&#160;URL it created on install (<a href="http://localhost/EmsPlatform">http://localhost/EmsPlatform</a>).</li>
            <li>To ensure Platform Services is working correctly,&#160;connect to&#160;<a href="http://localhost/EmsPlatform/admin">http://localhost/EmsPlatform/admin</a>&#160;and use an Admin Everyday User&#160;to verify you can log in.&#160;If you see license info, everything is working properly.</li>
        </ol>
        <ol start="2">
            <li>Uninstall&#160;any old version of EMS Kiosk App.&#160;</li>
        </ol>
        <p>Tip:&#160;We recommend that you&#160;take a moment now to record the IIS server, the SQL server name, the EMS DB name, etc.&#160;We also recommend creating a notepad file for the URLs that are generated&#160;for later reference.</p>
        <ol start="3">
            <li>Navigate to the&#160;<a href="http://www.dea.com/ServiceAndSupport/productdownloads.aspx" title="http://www.dea.com/ServiceAndSupport/productdownloads.aspx">Support Center</a>&#160;to obtain the latest version of the installation files.</li>
            <li>Load the&#160;EMS.Kiosk.App.msi&#160;file onto the web server that will be running the EMS Kiosk App.</li>
            <li>Run&#160;EMS.Kiosk.App.msi.</li>
            <li>The first screen welcomes you to the EMS Kiosk Setup Wizard. Click the&#160;Next&#160;button to begin the installation process.</li>
        </ol>
        <p>Welcome Screen to the EMS Kiosk Setup Wizard</p>
        <p>
            <img src="../Resources/Images/Kiosk_IG_InstallUpgrade1/Install or Upgrade the EMS.png" alt="EMSKiosk_InstallingUpgrading_KioskSetup.PNG" />
        </p>
        <ol start="7">
            <li>The Destination Folder screen will appear.&#160;</li>
        </ol>
        <p>Note:&#160;The default install folder for the EMS Kiosk App is not under wwwroot but under&#160;C:\Program Files. However, you can change the location of the default installation folder.</p>
        <p>Destination Folder</p>
        <p>
            <img src="../Resources/Images/Kiosk_IG_InstallUpgrade1/Install or Upgrade the EMS_1.png" alt="EMSKiosk_InstallingUpgrading_DestinationFolder.PNG" />
        </p>
        <p>Note:&#160;EMS Kiosk App should&#160;not&#160;be installed in the same physical directory as other EMS web-based products OR under a site running another version of the EMS Kiosk App.</p>
        <ol start="8">
            <li>In the EMS Application Settings screen, enter the&#160;EMS Platform Services URL&#160;and specify the&#160;Virtual Directory Name. See Also&#160;<a href="https://success.emssoftware.com/?title=Installation_%26_Setup_Guides/EMS_Platform_Services/Installing_EMS_Platform_Services" title="Installing EMS Platform Services">EMS Platform Services Installation Guide.&#160;</a></li>
        </ol>
        <p>EMS Application Settings Screen</p>
        <p>
            <img src="../Resources/Images/Kiosk_IG_InstallUpgrade1/Install or Upgrade the EMS_2.png" alt="EMSKiosk_InstallingUpgrading_ApplicationSettings.PNG" />
        </p>
        <ol start="9">
            <li>Enter your EMS Kiosk App path and click&#160;Next.&#160;The&#160;Virtual Directory&#160;screen will appear.</li>
        </ol>
        <p>Virtual Directory</p>
        <p>
            <img src="../Resources/Images/Kiosk_IG_InstallUpgrade1/Install or Upgrade the EMS_3.png" alt="EMSKiosk_InstallingUpgrading_VirtualDirectory.PNG" />
        </p>
        <ol start="10">
            <li>Enter the name you want to give to the virtual directory.&#160;Click&#160;Next.&#160;The&#160;Ready to Install&#160;screen will appear.</li>
        </ol>
        <p>Ready to Install Screen</p>
        <p>
            <img src="../Resources/Images/Kiosk_IG_InstallUpgrade1/Install or Upgrade the EMS_4.png" alt="EMSKiosk_InstallingUpgrading_ReadytoInstall.PNG" />
        </p>
        <ol start="11">
            <li>Click the&#160;Install&#160;button to install EMS Kiosk App.</li>
            <li>Open the&#160;appsettings.json&#160;file in Notepad. This file can be found in C:\Program Files\EMS Software\EMSKiosk.</li>
        </ol>
        <p>
            <img src="../Resources/Images/Kiosk_IG_InstallUpgrade1/Install or Upgrade the EMS_5.png" alt="Kiosk_IG_Appsettingsjson.PNG" />
        </p>
        <ol start="13">
            <li>Search for the section, "Platform Options." DO NOT&#160;EDIT ANYTHING except the next steps.&#160;If there are multiple (load balanced) nodes, you need to apply the Client Secret to all of them.</li>
            <li>Add a new line below the first {.<br />Type in:<br />“SecureCookies”: false,</li>
        </ol>
        <p>
            <img src="../Resources/Images/Kiosk_IG_InstallUpgrade1/Install or Upgrade the EMS_6.png" alt="PlatformOptions.PNG" />
        </p>
        <ol start="15">
            <li>Navigate to your Platform Services URL&#160;and log-in.</li>
            <li>Choose the&#160;Integrations&#160;Area.</li>
        </ol>
        <p>
            <img src="../Resources/Images/Kiosk_IG_InstallUpgrade1/Install or Upgrade the EMS_7.png" alt="Integrations.PNG" />
        </p>
        <ol start="17">
            <li>Select the EMS Kiosk service.</li>
        </ol>
        <ol start="1">
            <li>Copy the Client ID.</li>
            <li>In your notepad file, replace the Client ID area between the quotation marks. Do not delete the commas.</li>
        </ol>
        <p>
            <img src="../Resources/Images/Kiosk_IG_InstallUpgrade1/Install or Upgrade the EMS_8.png" alt="Kiosk_IG_Commas.PNG" />
        </p>
        <ol start="18">
            <li>Reset the client secret in the EMS Platform Admin UI:</li>
        </ol>
        <ol start="1">
            <li>Visit the Admin UI for you EMS Platform Services install (e.g.,&#160;<a href="https://my-company.com/EmsPlatform/admin" title="https://my-company.com/EmsPlatform/admin">https://my-company.com/EmsPlatform/admin</a>). You will need a Web User login with Administrative permissions to perform this step.&#160;</li>
            <li>Click the&#160;Reset Secret&#160;button.</li>
        </ol>
        <p>Reset Secret Button</p>
        <p>
            <img src="../Resources/Images/Kiosk_IG_InstallUpgrade1/Install or Upgrade the EMS_9.png" alt="EMSKiosk_InstallingUpgrading_ResetSecret.PNG" />
        </p>
        <ol start="3">
            <li>A new Client Secret is generated following the reset.</li>
        </ol>
        <p>New Client Secret</p>
        <p>
            <img src="../Resources/Images/Kiosk_IG_InstallUpgrade1/Install or Upgrade the EMS_10.png" alt="EMSKiosk_InstallingUpgrading_NewclientSecret.PNG" />
        </p>
        <ol start="4">
            <li>Copy the generated Client Secret after successful reset.&#160;</li>
        </ol>
        <p>Note:&#160;You will not be able to retrieve this secret later, instead you will have to reset the secret again to generate a new secret.</p>
        <ol start="5">
            <li>In your notepad file, replace the blank area between the QUOTES “” of ClientSecret with this code. Ensure that the quotations remain before and after the ClientSecret and that there are no spaces.&#160;</li>
        </ol>
        <p>Sample ClientSecret Value</p>
        <p>
            <img src="../Resources/Images/Kiosk_IG_InstallUpgrade1/Install or Upgrade the EMS_11.png" alt="EMSKiosk_InstallingUpgrading_SampleClientSecretvalue.PNG" />
        </p>
        <ol start="18">
            <li>Save and close the file. Overwrite the existing appsettings.json file. Ensure your overwrite worked by checking the date (your file should reflect the current date and time.)</li>
            <li>Reboot your server. Conversely, you could:</li>
        </ol>
        <ol start="1">
            <li>Open a CMD prompt as admin.</li>
            <li>Type: &#160;net stop was /y&#160;&lt;enter&gt;</li>
            <li>Type: &#160;net start w3svc&#160;&lt;enter&gt;</li>
        </ol>
        <ol start="20">
            <li>Clear the temp&#160;cache by closing&#160;your EMS Kiosk App browser window.</li>
            <li>Return to the EMS Platform Admin and set the Active, Enable Logging, and User Auth to&#160;CHECKED.</li>
            <li>Click&#160;Save.</li>
            <li>Choose the “Everyday User Auth Method” dropdown, and pick “NTLM.”</li>
            <li>Click&#160;Save.</li>
            <li>Choose the “Everyday User Auth Method” dropdown, and pick “EMS Native.”</li>
            <li>Click&#160;Save.</li>
            <li>Open the EMS Kiosk in a browser and follow the instructions in Starting the EMS Kiosk App.</li>
        </ol>
        <p>Note: By default, the EMS Kiosk App uses secure cookies. We strongly recommend you use this approach in your production environment. However, you may wish to test without SSL. To disable secure cookies in your test environment, add the following to appsettings.json inside the ‘PlatformOptions” section:</p>
        <p>
            <img src="../Resources/Images/Kiosk_IG_InstallUpgrade1/Install or Upgrade the EMS_12.png" alt="EMSKiosk_InstallingUpgrading_Cookie.PNG" />
        </p>
        <p>&#160;</p>
    </body>
</html>