<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" xml:lang="en-us" MadCap:lastBlockDepth="6" MadCap:lastHeight="4374" MadCap:lastWidth="1000" style="mc-master-page: url('..\..\..\Resources\MasterPages\emsMicrosoftOutlook.flmsp');">
    <head>
        <link href="../../../Resources/TableStyles/PatternedRows.css" rel="stylesheet" MadCap:stylesheetType="table" /><title></title>
    </head>
    <body>
        <h1>Configure Integration to Exchange</h1>
        <p>Configuring EMS to work with Exchange Online (Office 365) or Exchange 2013 is the same as configuring EMS to work with a 2007/2010 Exchange environment that is hosted on your network.&#160;See&#160;<MadCap:xref href="Outlook_IME_ConfigEWSImperforME.htm">Configuring EWS Impersonation for Microsoft® Exchange</MadCap:xref> for information on configuring impersonation on Exchange Online (Office 365).&#160;If you need additional assistance configuring this, please contact&#160;<a href="mailto:support@emssoftware.com" title="mailto:support@emssoftware.com">support@emssoftware.com</a>.</p>
        <p>This topic provides information on the following:&#160;</p>
        <ul>
            <li>
                <MadCap:xref href="#Configure_Integration_to_Exchange_Instructions">Configure Integration to Exchange Instructions</MadCap:xref>
            </li>
            <li>
                <MadCap:xref href="#Test_Your_Exchange_Integration">Test Your Exchange Integration</MadCap:xref>
            </li>
            <li>
                <MadCap:xref href="#Optional_Messaging_Settings">Optional Messaging Settings​</MadCap:xref>
                <ul>
                    <li>
                        <MadCap:xref href="#config">Enable Larger File Attachments On The Config&#160;File</MadCap:xref>
                    </li>
                    <li>
                        <MadCap:xref href="#database">Enable Larger File Attachments in the Exchange Integration Web Service</MadCap:xref>
                    </li>
                </ul>
            </li>
        </ul>
        <h2><a name="Configure_Integration_to_Exchange_Instructions"></a>Configure Integration to Exchange Instructions</h2>
        <ol start="1">
            <li>After following the&#160;<MadCap:xref href="Outlook_IME_InstallUpgradeforEIWservice.htm">installation instructions</MadCap:xref>, access the Integration with Exchange configuration area by opening a browser and entering the following:<p>http://[ServerName]/ExchangeIntegrationWebService/PamConfig.aspx&#160;(replace [ServerName] with the name of your web server)</p></li>
            <li>Go the&#160;Account Info&#160;tab.<a name="Tabs"></a>&#160;<p><img src="../../../Resources/Images/Integration to Microsoft/Configuring Integration to.png" /></p></li>
            <li>Select your email system in the&#160;Provider&#160;dropdown using the instructions provided on the page.</li>
            <li>Check the box “.. utilize AutoDiscover to locate the best Client Access Server for the user…”</li>
        </ol>
        <p>Note:&#160;If you do not check this box, you&#160;<span class="bold">must&#160;</span>fill in the&#160;Url to Exchange Web Services&#160;field.</p>
        <ol start="5">
            <li>Within the&#160;Authentication Information&#160;section, enter your Integration with Exchange Account&#160;User Name&#160;and&#160;Password.&#160;The User Name should be prefixed with your domain (example – YourDomain\Integration with Exchange Account, or Integration with Exchange Account@YourDomain)&#160;</li>
        </ol>
        <p>Tip:&#160;Make a note of this URL for use later in this topic.</p>
        <ol start="6">
            <li>(<span class="italics">Optional</span>)&#160;The “Use application pool identity…” option allows you to set the Integration with Exchange Account credentials at the Application Pool level instead of storing the credentials in the EMS database.&#160;See the&#160;<MadCap:xref href="Outlook_IME_UseAppPoolIdentif.htm">Use Application Pool Identity for Integration for Exchange Service Account</MadCap:xref>&#160;topic for more information about this option.&#160;If this option is selected, you&#160;must&#160;check the box to use Impersonation.&#160;</li>
            <li>If you selected “Exchange Web Services” as your&#160;Provider, select the checkbox if the account specified has Exchange Impersonation access to all mailboxes in your Exchange mailbox store.</li>
            <li>Select the Authentication Type:<ul start="6"><li><span class="bold">Anonymous&#160;</span>– No authentication</li><li><span class="bold">Specify Account</span>&#160;– Relies on a custom account (not the Integration with Exchange Account) that you create and manage.&#160;Please contact Customer Support (or a member of the Professional Services group if you are working with one) to discuss the configuration process for this option.</li><li><span class="bold">Default Credentials</span>&#160;– Relies on security context of EMS application calling the Integration with Exchange&#160;Web Service.&#160;If using this option, Integrated Windows Authentication should be enabled for the Integration with Exchange Web Service.</li><li>For MS Exchange 2007/2010 environments, click&#160;<span class="bold">Save</span>.&#160;Go to&#160;<MadCap:annotation MadCap:createDate="2017-12-01T15:55:48.8754156-07:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="Which step 1?" MadCap:editor="Megan.Laub" MadCap:editDate="2017-12-01T15:55:51.6644221-07:00">Step 1</MadCap:annotation>.</li></ul></li>
        </ol>
        <p>Note:&#160;When testing Integration with Exchange, the email account that is being used (either on the Test Settings tab or in the "Testing Integration with Exchange" section below) MUST exist in the Exchange environment being tested.&#160;If you are testing Integration with Exchange in a development environment please verify that a mailbox for the email being used exists in that domain/environment.</p>
        <ol start="9">
            <li>Click&#160;<span class="bold">Test Configuration</span>.&#160;If any errors are encountered, please verify your configuration. Otherwise, your Integration with Exchange configuration is complete.&#160;</li>
        </ol>
        <h2><a name="Test_Your_Exchange_Integration"></a>Test Your Exchange Integration</h2>
        <ol start="1">
            <li>To test your &#160;configuration, you will need to log into EMS Web App with a user account (configured with the user’s primary email address) belonging to a Everyday Application Process Template (within the EMS client application) that has the&#160;<MadCap:xref href="../../../2WebApp/A_V44.1/B_ConfigurationGuide/WebApp_CG_EverydayUserProcTempFieldDef.html">Enable Integration to Microsoft Exchange</MadCap:xref>&#160;option checked.&#160;</li>
            <li>Log into EMS Web App. Begin making a reservation and selecting a room.</li>
            <li>Select the&#160;<span class="bold">Add to my calendar</span>&#160;checkbox.&#160;If this option is not available, please verify (within the EMS client application) that your user account belongs to a Everyday User Process Template that has the&#160;<span class="bold">Allow Invitations</span>&#160;option checked.&#160;</li>
            <li>Find and add&#160;an attendee using the&#160;Find Attendee&#160;field.</li>
            <li>Complete necessary information on the&#160;<span class="bold">Details&#160;</span>tab and click&#160;<span class="bold">Submit Reservation</span>.</li>
            <li>Verify that an appointment was added to your Outlook Calendar and that your attendee received an invitation.</li>
        </ol>
        <h2><a name="Optional_Messaging_Settings"></a>Optional Messaging Settings​</h2>
        <p>The options on the <span class="bold">Message </span>tab (as reached&#160;above in&#160;<MadCap:xref href="#Tabs">Step 2</MadCap:xref>)&#160;shown below guide you in further configuring your integration.</p>
        <p>
            <img src="../../../Resources/Images/Integration to Microsoft/Configuring Integration to_2.png" />
        </p>
        <p>Message Tab Fields</p>
        <table style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/PatternedRows.css');" class="TableStyle-PatternedRows" cellspacing="0">
            <col class="TableStyle-PatternedRows-Column-Regular" />
            <col class="TableStyle-PatternedRows-Column-Regular" />
            <thead>
                <tr class="TableStyle-PatternedRows-Head-Header1">
                    <th class="TableStyle-PatternedRows-HeadE-Regular-Header1">Field </th>
                    <th class="TableStyle-PatternedRows-HeadD-Regular-Header1">Description</th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-PatternedRows-Body-LightRows">
                    <td class="TableStyle-PatternedRows-BodyE-Regular-LightRows"><span class="bold">Message To Append</span>
                    </td>
                    <td class="TableStyle-PatternedRows-BodyD-Regular-LightRows">Message appended to the bottom of the appointment body.&#160;This message is seen by all users.</td>
                </tr>
                <tr class="TableStyle-PatternedRows-Body-DarkerRows">
                    <td class="TableStyle-PatternedRows-BodyE-Regular-DarkerRows"><span class="bold">To view the details of this reservation click the below link</span>
                    </td>
                    <td class="TableStyle-PatternedRows-BodyD-Regular-DarkerRows">Message added to the appointment body, above a link that takes a user to a view-only EMS Web App page for the appointment.&#160;This message is seen by all users.</td>
                </tr>
                <tr class="TableStyle-PatternedRows-Body-LightRows">
                    <td class="TableStyle-PatternedRows-BodyE-Regular-LightRows"><span class="bold">If you are the meeting organizer click the below link to edit the reservation</span>
                    </td>
                    <td class="TableStyle-PatternedRows-BodyD-Regular-LightRows">Message added to the appointment body, above a link that takes the meeting organizer to the EMS Web App Reservation Summary page for that reservation.&#160;This message is seen by all users, but only the meeting organizer can access the Reservation Summary page to make changes.</td>
                </tr>
                <tr class="TableStyle-PatternedRows-Body-DarkerRows">
                    <td class="TableStyle-PatternedRows-BodyE-Regular-DarkerRows"><span class="bold">Allow Attachments</span>
                    </td>
                    <td class="TableStyle-PatternedRows-BodyD-Regular-DarkerRows">Allows users to add attachments within EMS Web App when making an appointment.</td>
                </tr>
                <tr class="TableStyle-PatternedRows-Body-LightRows">
                    <td class="TableStyle-PatternedRows-BodyB-Regular-LightRows"><span class="bold">Maximum Attachment Size</span>
                    </td>
                    <td class="TableStyle-PatternedRows-BodyA-Regular-LightRows">If attachments are allowed, set&#160;the maximum file size allowed for an attachment.</td>
                </tr>
            </tbody>
        </table>
        <p>Concept:&#160;The default installation allows&#160;file attachments up to 4MB.&#160;If your implementation needs file attachments that are larger, follow the two procedures&#160;below:</p>
        <ol start="1">
            <li>Update the <MadCap:xref href="#config">config file</MadCap:xref>.</li>
            <li>Update the <MadCap:xref href="#database">database</MadCap:xref>.&#160;</li>
        </ol>
        <p>Note:&#160;File sizes larger than 2 GB are not allowed at this time.</p>
        <h3>Enable Larger File Attachments On The Config&#160;File<a name="config"></a></h3>
        <p>By default, Exchange Integration attachments will only accept files 4MB or less.&#160;If your implementation needs to allow files of larger sizes to be attached to reservations, the following config updates will be required, both in EMS Web App&#160;and in the Exchange Integration Web Service.&#160;</p>
        <p>Important:&#160;The maximum file size is 2 GB.</p>
        <ol start="1">
            <li>In the&#160;&lt;system.webServer&gt;&#160;section, include this xml node:</li>
        </ol>
        <p>&lt;security&gt;</p>
        <p>&#160;&#160;&#160;&#160;&#160; &lt;requestFiltering&gt;</p>
        <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;requestLimits&#160;maxAllowedContentLength="51200000"/&gt; &lt;!--maxAllowedContentLength in bytes, 50MB=51200000--&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</p>
        <p>&#160;&#160;&#160;&#160;&#160;&#160;&lt;/requestFiltering&gt;</p>
        <p>&#160;&#160;&#160; &lt;/security&gt;</p>
        <ol start="2">
            <li>In the&#160;&lt;httpRuntime&#160;element, add these highlighted attributes with the end result looking like this:</li>
        </ol>
        <p>&lt;httpRuntime&#160;targetFramework="4.5"&#160;requestLengthDiskThreshold="2147483644"&#160;maxRequestLength="51200"&#160;&#160;/&gt;&#160; &lt;!—-requestLengthDiskThreshold in bytes, &amp; maxRequestLength in KB, 50MB--&gt;</p>
        <ol start="3">
            <li>Under the&#160;&lt;appSettings&gt;&#160;look for the “MaximumUploadSizeInBytes” key.&#160; Update this value to the number of bytes allowed.&#160; For instance, 50MB would look like this:</li>
        </ol>
        <p>&lt;add&#160;key="MaximumUploadSizeInBytes"&#160;value="52428800000"/&gt;&#160; &lt;!—- in&#160;bytes50MB--&gt;&#160;</p>
        <h3>Enable Larger File Attachments in the Exchange Integration Web Service<a name="database"></a><img src="../../../Resources/Images/Integration to Microsoft/Configuring Integration to.gif" alt="Edit section" class="img_1" /></h3>
        <p>By default Exchange Integration attachments will only accept files 4MB or less. If your implementation needs to allow for Exchange message attachments larger than 4MB, the config updates above will need to be applied in the Exchange Integration Web Service.</p>
        <p>Note:&#160;Due to the size of the xml sent, we recommend adding 5MB to the desired file upload size. (i.e., if you want to allow a max of 20MB files, calculate a total of 25MB worth of Kilobytes and bytes.</p>
        <p>In addition to these web.config settings above, a web administrator will need to update the file size in the Exchange Integration Web Service as follows:</p>
        <ol start="1">
            <li>Navigate to the Exchange Integration Web Service/PAMConfig.aspx</li>
            <li>Click the <span class="bold">Message </span>tab</li>
            <li>Update the&#160;<span class="bold">Maximum Attachment Size</span>&#160;text box and <span class="bold">Save</span>.</li>
        </ol>
        <p>Warning:&#160;<span class="bold">For&#160;Externally Exposed Web App sites</span>—if your EMS Web App site is externally exposed, some of the web.config settings above could make the site vulnerable to DoS site attacks. We highly recommend setting network-level protection to prevent DoS attacks.</p>
    </body>
</html>